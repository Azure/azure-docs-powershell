### YamlMime:PowershellCmdlet
summary: |-
  Sets the logs and metrics settings for the resource.
module: Az.Monitor
notes: ""
inputs:
- name: <xref href="Microsoft.Azure.Commands.Insights.OutputClasses.PSServiceDiagnosticSettings" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Collections.Generic.List`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" data-throw-if-not-resolved="False" /><span>]</span><span>]</span>
  description: ""
- name: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" data-throw-if-not-resolved="False" /><span>]</span><span>]</span>
  description: ""
- name: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" data-throw-if-not-resolved="False" /><span>]</span><span>]</span>
  description: ""
outputs:
- name: <xref href="Microsoft.Azure.Commands.Insights.OutputClasses.PSServiceDiagnosticSettings" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-AzDiagnosticSetting
  href: ./Get-AzDiagnosticSetting.yml
- text: Remove-AzDiagnosticSetting
  href: ./Remove-AzDiagnosticSetting.yml
syntaxes:
- >-
  Set-AzDiagnosticSetting -ResourceId <String> [-Name <String>] [-StorageAccountId <String>]

   [-ServiceBusRuleId <String>] [-EventHubName <String>] [-EventHubAuthorizationRuleId <String>]

   [-Enabled <Boolean>] [-Category <System.Collections.Generic.List`1[System.String]>]

   [-MetricCategory <System.Collections.Generic.List`1[System.String]>]

   [-Timegrain <System.Collections.Generic.List`1[System.String]>] [-RetentionEnabled <Boolean>]

   [-WorkspaceId <String>] [-RetentionInDays <Int32>] [-ExportToResourceSpecific] [-EnableLog <Boolean>]

   [-EnableMetrics <Boolean>] [-DefaultProfile <IAzureContextContainer>] [-WhatIf] [-Confirm]

   [<CommonParameters>]
- >-
  Set-AzDiagnosticSetting -InputObject <PSServiceDiagnosticSettings> [-DefaultProfile <IAzureContextContainer>]

   [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Enable all metrics and logs for a resource'
  code: |-
    PS C:\>Set-AzDiagnosticSetting -ResourceId "Resource01" -Enabled $True
  description: |-
    This command enables all available metrics and logs for Resource01.
  summary: ""
- title: 'Example 2: Disable all metrics and logs'
  code: |-
    PS C:\>Set-AzDiagnosticSetting -ResourceId "Resource01" -Enabled $False
  description: |-
    This command disables all available metrics and logs for the resource Resource01.
  summary: ""
- title: 'Example 3: Enable/disable multiple metrics categories'
  code: |-
    PS C:\>Set-AzDiagnosticSetting -ResourceId "Resource01" -Enabled $False -MetricCategory MetricCategory1,MetricCategory2
    StorageAccountId   : <storageAccountId>
    StorageAccountName : <storageAccountName>
    Metrics
       Enabled   : False
       Category  : MetricCategory1
       Timegrain : PT1M
       Enabled   : False
       Category  : MetricCategory2
       Timegrain : PT1H
       Enabled   : True
       Category  : MetricCategory3
       Timegrain : PT1H
    Logs
       Enabled  : True
       Category : Category1
       Enabled  : True
       Category : Category2
       Enabled  : True
       Category : Category3
       Enabled  : False
       Category : Category4
  description: |-
    This command disables the metrics categories called Category1 and Category2.
    All the other categories remain the same.
  summary: ""
- title: 'Example 4: Enable/disable multiple log categories'
  code: |-
    PS C:\>Set-AzDiagnosticSetting -ResourceId "Resource01" -Enabled $True -Category Category1,Category2
    StorageAccountId   : <storageAccountId>
    StorageAccountName : <storageAccountName>
    Metrics
       Enabled   : False
       Category  : MetricCategory1
       Timegrain : PT1M
       Enabled   : False
       Category  : MetricCategory2
       Timegrain : PT1H
       Enabled   : True
       Category  : MetricCategory3
       Timegrain : PT1H
    Logs
       Enabled  : True
       Category : Category1
       Enabled  : True
       Category : Category2
       Enabled  : True
       Category : Category3
       Enabled  : False
       Category : Category4
  description: |-
    This command enables Category1 and Category2.
    All the other metrics and logs categories remain the same.
  summary: ""
- title: 'Example 5: Enable a time grain and multiple categories'
  code: |-
    PS C:\>Set-AzDiagnosticSetting -ResourceId "Resource01" -Enabled $True -Category Category1,Category2 -Timegrain PT1M
  description: |-
    This command enables only Category1, Category2, and time grain PT1M.
    All other time grains and categories are unchanged.
  summary: ""
- title: 'Example 6: Using pipeline'
  code: |-
    PS C:\>Get-AzDiagnosticSetting -ResourceId "Resource01" | Set-AzDiagnosticSetting -Enabled $True -Category Category1,Category2
  description: |-
    This command uses the PowerShell pipeline to set (no change made) a diagnostic setting.
  summary: ""
parameters:
- type: <xref href="System.Collections.Generic.List`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.String" data-throw-if-not-resolved="False" /><span>]</span>
  name: Category
  description: |+
    Specifies the list of log categories to enable or disable, according to the value of *Enabled*.
    If no category is specified, this command operates on all supported categories. 

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.Core.IAzureContextContainer" data-throw-if-not-resolved="False" />
  name: DefaultProfile
  description: |+
    The credentials, account, tenant, and subscription used for communication with azure

  defaultValue: None
  position: Named
  aliases: AzContext, AzureRmContext, AzureCredential
  parameterValueGroup: ""
- type: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  name: Enabled
  description: |+
    Indicates whether to enable diagnostics.
    Specify $True to enable diagnostics, or $False to disable diagnostics.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  name: EnableLog
  description: |+
    The value indicating whether the diagnostic logs should be enabled or disabled

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  name: EnableMetrics
  description: |+
    The value indicating whether the diagnostic metrics should be enabled or disabled

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: EventHubAuthorizationRuleId
  description: |+
    The event hub authorization rule id

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: EventHubName
  description: |+
    The event hub name

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: ExportToResourceSpecific
  description: |+
    Flag indicating that the export to LA must be done to a resource specific table, a.k.a. dedicated or fixed schema table, as opposed to the **default** dynamic schema table called **AzureDiagnostics**.

    This argument is effective only when the argument **-workspaceId** is also given.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Insights.OutputClasses.PSServiceDiagnosticSettings" data-throw-if-not-resolved="False" />
  name: InputObject
  isRequired: true
  description: |+
    The input object (possible from the pipeline.) The name and resourceId will be extracted from this object.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Collections.Generic.List`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.String" data-throw-if-not-resolved="False" /><span>]</span>
  name: MetricCategory
  description: |+
    The list of metric categories. 
    If no category is specified, this command operates on all supported categories. 

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Name
  description: |+
    The name of the diagnostic setting. The default value is **service**.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ResourceId
  isRequired: true
  description: |+
    Specifies the ID of the resource.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Boolean" data-throw-if-not-resolved="False" /><span>]</span>
  name: RetentionEnabled
  description: |+
    Indicates whether retention of diagnostic information is enabled.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32" data-throw-if-not-resolved="False" /><span>]</span>
  name: RetentionInDays
  description: |+
    Specifies the retention policy, in days.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ServiceBusRuleId
  description: |+
    The Service Bus Rule id.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: StorageAccountId
  description: |+
    Specifies the ID of the Storage account in which to save the data.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Collections.Generic.List`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.String" data-throw-if-not-resolved="False" /><span>]</span>
  name: Timegrain
  description: |+
    Specifies the time grains to enable or disable for metrics, according to the value of *Enabled*.
    If you do not specify a time grain, this command operates on all available time grains.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs. The cmdlet is not run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: WorkspaceId
  description: |+
    The resource Id of the Log Analytics workspace to send logs/metrics to

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: Az.Monitor.Set-AzDiagnosticSetting
name: Set-AzDiagnosticSetting
description: |-
  The **Set-AzDiagnosticSetting** cmdlet enables or disables each time grain and log category for the particular resource.
  The logs and metrics are stored in the specified storage account.
  This cmdlet implements the ShouldProcess pattern, i.e. it might request confirmation from the user before actually creating, modifying, or removing the resource.
metadata:
  external help file: Microsoft.Azure.PowerShell.Cmdlets.Monitor.dll-Help.xml
  Module Name: Az.Monitor
  ms.assetid: B5F2388E-0136-4F8A-8577-67CE2A45671E
  online version: https://docs.microsoft.com/en-us/powershell/module/az.monitor/set-azdiagnosticsetting
  schema: 2.0.0
  content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Monitor/Monitor/help/Set-AzDiagnosticSetting.md
  original_content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Monitor/Monitor/help/Set-AzDiagnosticSetting.md
