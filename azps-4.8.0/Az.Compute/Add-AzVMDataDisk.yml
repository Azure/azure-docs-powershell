### YamlMime:PowershellCmdlet
summary: |-
  Adds a data disk to a virtual machine.
module: Az.Compute
notes: ""
inputs:
- name: <xref href="Microsoft.Azure.Commands.Compute.Models.PSVirtualMachine" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="Microsoft.Azure.Management.Compute.Models.CachingTypes" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" data-throw-if-not-resolved="False" /><span>]</span><span>]</span>
  description: ""
outputs:
- name: <xref href="Microsoft.Azure.Commands.Compute.Models.PSVirtualMachine" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="Microsoft.Azure.Commands.Compute.Automation.Models.PSVirtualMachineScaleSetVM" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Remove-AzVMDataDisk
  href: ./Remove-AzVMDataDisk.yml
- text: Get-AzVM
  href: ./Get-AzVM.yml
- text: New-AzVMConfig
  href: ./New-AzVMConfig.yml
syntaxes:
- >-
  Add-AzVMDataDisk [-VM] <PSVirtualMachine> [[-Name] <String>] [[-VhdUri] <String>] [[-Caching] <CachingTypes>]

   [[-DiskSizeInGB] <Int32>] [-Lun] <Int32> [-CreateOption] <String> [[-SourceImageUri] <String>]

   [-DiskEncryptionSetId <String>] [-DefaultProfile <IAzureContextContainer>] [<CommonParameters>]
- >-
  Add-AzVMDataDisk [-VM] <PSVirtualMachine> [[-Name] <String>] [[-Caching] <CachingTypes>]

   [[-DiskSizeInGB] <Int32>] [-Lun] <Int32> [-CreateOption] <String> [[-ManagedDiskId] <String>]

   [[-StorageAccountType] <String>] [-DiskEncryptionSetId <String>] [-WriteAccelerator]

   [-DefaultProfile <IAzureContextContainer>] [<CommonParameters>]
examples:
- title: 'Example 1: Add data disks to a new virtual machine'
  code: |-
    PS C:\> $VirtualMachine = New-AzVMConfig -VMName "VirtualMachine07" -VMSize "Standard_A1"
    PS C:\> $DataDiskVhdUri01 = "https://contoso.blob.core.windows.net/test/data1.vhd"
    PS C:\> $DataDiskVhdUri02 = "https://contoso.blob.core.windows.net/test/data2.vhd"
    PS C:\> $DataDiskVhdUri03 = "https://contoso.blob.core.windows.net/test/data3.vhd"
    PS C:\> $VirtualMachine = Add-AzVMDataDisk -VM $VirtualMachine -Name 'DataDisk1' -Caching 'ReadOnly' -DiskSizeInGB 10 -Lun 0 -VhdUri $DataDiskVhdUri01 -CreateOption Empty
    PS C:\> $VirtualMachine = Add-AzVMDataDisk -VM $VirtualMachine -Name 'DataDisk2' -Caching 'ReadOnly' -DiskSizeInGB 11 -Lun 1 -VhdUri $DataDiskVhdUri02 -CreateOption Empty
    PS C:\> $VirtualMachine = Add-AzVMDataDisk -VM $VirtualMachine -Name 'DataDisk3' -Caching 'ReadOnly' -DiskSizeInGB 12 -Lun 2 -VhdUri $DataDiskVhdUri03 -CreateOption Empty
  description: |-
    The first command creates a virtual machine object, and then stores it in the $VirtualMachine variable.
    The command assigns a name and size to the virtual machine.
    The next three commands assign paths of three data disks to the $DataDiskVhdUri01, $DataDiskVhdUri02, and $DataDiskVhdUri03 variables.
    This approach is only for readability of the following commands.
    The final three commands each adds a data disk to the virtual machine stored in $VirtualMachine.
    The command specifies the name and location for the disk, and other properties of the disk.
    The URI of each disk is stored in $DataDiskVhdUri01, $DataDiskVhdUri02, and $DataDiskVhdUri03.
  summary: ""
- title: 'Example 2: Add a data disk to an existing virtual machine'
  code: |-
    PS C:\> $VirtualMachine = Get-AzVM -ResourceGroupName "ResourceGroup11" -Name "VirtualMachine07"
    PS C:\> Add-AzVMDataDisk -VM $VirtualMachine -Name "disk1" -VhdUri "https://contoso.blob.core.windows.net/vhds/diskstandard03.vhd" -LUN 0 -Caching ReadOnly -DiskSizeinGB 1 -CreateOption Empty
    PS C:\> Update-AzVM -ResourceGroupName "ResourceGroup11" -VM $VirtualMachine
  description: |-
    The first command gets the virtual machine named VirtualMachine07 by using the [Get-AzVM](./Get-AzVM.yml) cmdlet.
    The command stores the virtual machine in the $VirtualMachine variable.
    The second command adds a data disk to the virtual machine stored in $VirtualMachine.
    The final command updates the state of the virtual machine stored in $VirtualMachine in ResourceGroup11.
  summary: ""
- title: 'Example 3: Add a data disk to a new virtual machine from a generalized user image'
  code: |-
    PS C:\> $VirtualMachine = New-AzVMConfig -VMName "VirtualMachine07" -VMSize "Standard_A1"
    PS C:\> $DataImageUri = "https://contoso.blob.core.windows.net/system/Microsoft.Compute/Images/captured/dataimage.vhd"
    PS C:\> $DataDiskUri = "https://contoso.blob.core.windows.net/test/datadisk.vhd"
    PS C:\> $VirtualMachine = Add-AzVMDataDisk -VM $VirtualMachine -Name "disk1" -SourceImageUri $DataImageUri -VhdUri $DataDiskUri -Lun 0 -DiskSizeinGB 10 -CreateOption FromImage
  description: |-
    The first command creates a virtual machine object and stores it in the $VirtualMachine variable.
    The command assigns a name and size to the virtual machine.
    The next two commands assign paths for the data image and data disks to the $DataImageUri and $DataDiskUri variables respectively.
    This approach is used to improve the readability of the following commands.
    The final commands adds a data disk to the virtual machine stored in $VirtualMachine.
    The command specifies the name and location for the disk and other properties of the disk.
  summary: ""
- title: 'Example 4: Add data disks to a new virtual machine from a specialized user image'
  code: |-
    PS C:\> $VirtualMachine = New-AzVMConfig -VMName "VirtualMachine07" -VMSize "Standard_A1"
    PS C:\> $DataDiskUri = "https://contoso.blob.core.windows.net/test/datadisk.vhd"
    PS C:\> $VirtualMachine = Add-AzVMDataDisk -VM $VirtualMachine -Name "dd1" -VhdUri $DataDiskUri -Lun 0 -DiskSizeinGB 10 -CreateOption Attach
  description: |-
    The first command creates a virtual machine object and stores it in the $VirtualMachine variable.
    The command assigns a name and size to the virtual machine.
    The next commands assigns paths of the data disk to the $DataDiskUri variable.
    This approach is used to improve the readability of the following commands.
    The final command add a data disk to the virtual machine stored in $VirtualMachine.
    The command specifies the name and location for the disk, and other properties of the disk.
  summary: ""
parameters:
- type: <xref href="Microsoft.Azure.Management.Compute.Models.CachingTypes" data-throw-if-not-resolved="False" />
  name: Caching
  description: |+
    Specifies the caching mode of the disk.
    The acceptable values for this parameter are:
    - ReadOnly
    - ReadWrite
    - None
    The default value is ReadWrite.
    Changing this value causes the virtual machine to restart.
    This setting affects the consistency and performance of the disk.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: ""
  parameterValueGroup: None, ReadOnly, ReadWrite
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: CreateOption
  isRequired: true
  description: |+
    Specifies whether this cmdlet creates a disk in the virtual machine from a platform or user image, creates an empty disk, or attaches an existing disk.
    The acceptable values for this parameter are:
    - Attach.
    Specify this option to create a virtual machine from a specialized disk.
    When you specify this option, do not specify the *SourceImageUri* parameter.
    The *VhdUri* is all that is needed in order to tell the Azure platform the location of the virtual hard disk (VHD) to attach as a data disk to the virtual machine.
    - Empty.
    Specify this to create an empty data disk.
    - FromImage.
    Specify this option to create a virtual machine from a generalized image or disk.
    When you specify this option, you must specify the *SourceImageUri* parameter also in order to tell the Azure platform the location of the VHD to attach as a data disk.
    The *VhdUri* parameter is used as the location identifying where the data disk VHD will be stored when it is used by the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "6"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.Core.IAzureContextContainer" data-throw-if-not-resolved="False" />
  name: DefaultProfile
  description: |+
    The credentials, account, tenant, and subscription used for communication with azure.

  defaultValue: None
  position: Named
  aliases: AzContext, AzureRmContext, AzureCredential
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DiskEncryptionSetId
  description: |+
    Specifies the resource Id of customer managed disk encryption set.  This can only be specified for managed disk.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32" data-throw-if-not-resolved="False" /><span>]</span>
  name: DiskSizeInGB
  description: |+
    Specifies the size, in gigabytes, of an empty disk to attach to a virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "4"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Nullable`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Int32" data-throw-if-not-resolved="False" /><span>]</span>
  name: Lun
  isRequired: true
  description: |+
    Specifies the logical unit number (LUN) for a data disk.

  defaultValue: None
  pipelineInput: true
  position: "5"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ManagedDiskId
  description: |+
    Specifies the ID of a managed disk.

  defaultValue: None
  pipelineInput: true
  position: "8"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Name
  description: |+
    Specifies the name of the data disk to add.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: SourceImageUri
  description: |+
    Specifies the source URI of the disk that this cmdlet attaches.

  defaultValue: None
  pipelineInput: true
  position: "7"
  aliases: SourceImage
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: StorageAccountType
  description: |+
    Specifies the storage account type of managed disk.

  defaultValue: None
  pipelineInput: true
  position: "9"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: VhdUri
  description: |+
    Specifies the Uniform Resource Identifier (URI) for the virtual hard disk (VHD) file to create when a platform image or user image is used.
    This cmdlet copies the image binary large object (blob) to this location.
    This is the location from which to start the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Compute.Models.PSVirtualMachine" data-throw-if-not-resolved="False" />
  name: VM
  isRequired: true
  description: |+
    Specifies the local virtual machine object to which to add a data disk.
    You can use the **Get-AzVM** cmdlet to obtain a virtual machine object.
    You can use the **New-AzVMConfig** cmdlet to create a virtual machine object.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: VMProfile
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: WriteAccelerator
  description: |+
    Specifies whether WriteAccelerator should be enabled or disabled on a managed data disk.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
uid: Az.Compute.Add-AzVMDataDisk
name: Add-AzVMDataDisk
description: |-
  The **Add-AzVMDataDisk** cmdlet adds a data disk to a virtual machine.
  You can add a data disk when you create a virtual machine, or you can add a data disk to an existing virtual machine.
metadata:
  external help file: Microsoft.Azure.PowerShell.Cmdlets.Compute.dll-Help.xml
  Module Name: Az.Compute
  ms.assetid: 169E6694-82CD-4FCB-AB3D-E8A74001B8DB
  online version: https://docs.microsoft.com/en-us/powershell/module/az.compute/add-azvmdatadisk
  schema: 2.0.0
  content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Add-AzVMDataDisk.md
  original_content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Add-AzVMDataDisk.md
