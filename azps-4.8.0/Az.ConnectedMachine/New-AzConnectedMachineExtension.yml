### YamlMime:PowershellCmdlet
summary: |-
  The operation to create or update the extension.
module: Az.ConnectedMachine
notes: |-
  ALIASES

  COMPLEX PARAMETER PROPERTIES

  To create the parameters described below, construct a hash table containing the appropriate properties. For information on hash tables, run Get-Help about_Hash_Tables.


  EXTENSIONPARAMETER <IMachineExtension>: Describes a Machine Extension.
    - `Location <String>`: The geo-location where the resource lives
    - `[Tag <ITrackedResourceTags>]`: Resource tags.
      - `[(Any) <String>]`: This indicates any property can be added to this object.
    - `[AutoUpgradeMinorVersion <Boolean?>]`: Indicates whether the extension should use a newer minor version if one is available at deployment time. Once deployed, however, the extension will not upgrade minor versions unless redeployed, even with this property set to true.
    - `[ForceUpdateTag <String>]`: How the extension handler should be forced to update even if the extension configuration has not changed.
    - `[MachineExtensionType <String>]`: Specifies the type of the extension; an example is "CustomScriptExtension".
    - `[ProtectedSetting <IMachineExtensionPropertiesProtectedSettings>]`: The extension can contain either protectedSettings or protectedSettingsFromKeyVault or no protected settings at all.
    - `[Publisher <String>]`: The name of the extension handler publisher.
    - `[Setting <IMachineExtensionPropertiesSettings>]`: Json formatted public settings for the extension.
    - `[TypeHandlerVersion <String>]`: Specifies the version of the script handler.

  INPUTOBJECT <IConnectedMachineIdentity>: Identity Parameter
    - `[ExtensionName <String>]`: The name of the machine extension.
    - `[Id <String>]`: Resource identity path
    - `[Name <String>]`: The name of the hybrid machine.
    - `[ResourceGroupName <String>]`: The name of the resource group.
    - `[SubscriptionId <String>]`: Subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
inputs:
- name: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.Api20200802.IMachineExtension" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.IConnectedMachineIdentity" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.Api20200802.IMachineExtension" data-throw-if-not-resolved="False" />
  description: ""
syntaxes:
- >-
  New-AzConnectedMachineExtension -MachineName <String> -Name <String> -ResourceGroupName <String>

   -Location <String> [-SubscriptionId <String>] [-AutoUpgradeMinorVersion] [-ExtensionType <String>]

   [-ForceRerun <String>] [-ProtectedSetting <IMachineExtensionPropertiesProtectedSettings>]

   [-Publisher <String>] [-Setting <IMachineExtensionPropertiesSettings>] [-Tag <Hashtable>]

   [-TypeHandlerVersion <String>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-Confirm] [-WhatIf]

   [<CommonParameters>]
- >-
  New-AzConnectedMachineExtension -MachineName <String> -Name <String> -ResourceGroupName <String>

   -ExtensionParameter <IMachineExtension> [-SubscriptionId <String>] [-DefaultProfile <PSObject>] [-AsJob]

   [-NoWait] [-Confirm] [-WhatIf] [<CommonParameters>]
- >-
  New-AzConnectedMachineExtension -InputObject <IConnectedMachineIdentity>

   -ExtensionParameter <IMachineExtension> [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-Confirm] [-WhatIf]

   [<CommonParameters>]
- >-
  New-AzConnectedMachineExtension -InputObject <IConnectedMachineIdentity> -Location <String>

   [-AutoUpgradeMinorVersion] [-ExtensionType <String>] [-ForceRerun <String>]

   [-ProtectedSetting <IMachineExtensionPropertiesProtectedSettings>] [-Publisher <String>]

   [-Setting <IMachineExtensionPropertiesSettings>] [-Tag <Hashtable>] [-TypeHandlerVersion <String>]

   [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-Confirm] [-WhatIf] [<CommonParameters>]
examples:
- title: 'Example 1: Add a new extension to a machine'
  code: |-
    PS C:\> $Settings = @{ "commandToExecute" = "powershell.exe -c Get-Process" }
    PS C:\> New-AzConnectedMachineExtension -Name custom -ResourceGroupName ContosoTest -MachineName win-eastus1 -Location eastus -Publisher "Microsoft.Compute" -TypeHandlerVersion 1.10 -Settings $Settings -ExtensionType CustomScriptExtension

    Name   Location ProvisioningState
    ----   -------- -----------------
    custom eastus   Succeeded
  description: |-
    Sets an extension on a machine.
  summary: ""
- title: 'Example 2: Add a new extension with extension parameters specified via the pipeline'
  code: |-
    PS C:\> $otherExtension = Get-AzConnectedMachineExtension -Name custom -ResourceGroupName ContosoTest -MachineName other
    PS C:\> $otherExtension | New-AzConnectedMachineExtension -Name custom -ResourceGroupName ContosoTest -MachineName important

    Name   Location ProvisioningState
    ----   -------- -----------------
    custom eastus   Succeeded
  description: |-
    This creates a new extension with the extension parameters provided by the object passed in via the pipeline.
    This is great if you want to grab the parameters of one machine and apply it to another machine.
  summary: ""
- title: 'Example 3: Add a new extension with location specified via the pipeline'
  code: |-
    PS C:\> $identity = [Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.ConnectedMachineIdentity]@{
        Id = "/subscriptions/$($SubscriptionId)/resourceGroups/$($ResourceGroupName)/providers/Microsoft.HybridCompute/machines/$MachineName/extensions/$ExtensionName"
    }
    PS C:\> $Settings = @{ "commandToExecute" = "powershell.exe -c Get-Process" }
    PS C:\> $identity | New-AzConnectedMachineExtension -Location eastus -Publisher "Microsoft.Compute" -TypeHandlerVersion 1.10 -Settings $Settings -ExtensionType CustomScriptExtension

    Name   Location ProvisioningState
    ----   -------- -----------------
    custom eastus   Succeeded
  description: |-
    This creates a new machine extension using the identity provided via the pipeline.
    You likely won't do this, but it's possible.
  summary: ""
- title: 'Example 4: Add a new extension using an extension object as both the location and parameters for updating'
  code: |-
    PS C:\> $ext = Get-AzConnectedMachineExtension -Name custom -ResourceGroupName ContosoTest -MachineName other
    PS C:\> $ext | New-AzConnectedMachineExtension -ExtensionParameter $ext
  description: |-
    This creates a new machine extension using the identity provided via the pipeline and the extension details provided by the passed in extension object.
    You likely won't do this, but it's possible.
  summary: ""
parameters:
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Run the command as a job

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: AutoUpgradeMinorVersion
  description: |+
    Indicates whether the extension should use a newer minor version if one is available at deployment time.
    Once deployed, however, the extension will not upgrade minor versions unless redeployed, even with this property set to true.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.PSObject" data-throw-if-not-resolved="False" />
  name: DefaultProfile
  description: |+
    The credentials, account, tenant, and subscription used for communication with Azure.

  defaultValue: None
  position: Named
  aliases: AzureRMContext, AzureCredential
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.Api20200802.IMachineExtension" data-throw-if-not-resolved="False" />
  name: ExtensionParameter
  isRequired: true
  description: |+
    Describes a Machine Extension.
    To construct, see NOTES section for EXTENSIONPARAMETER properties and create a hash table.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ExtensionType
  description: |+
    Specifies the type of the extension; an example is "CustomScriptExtension".

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ForceRerun
  description: |+
    How the extension handler should be forced to update even if the extension configuration has not changed.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.IConnectedMachineIdentity" data-throw-if-not-resolved="False" />
  name: InputObject
  isRequired: true
  description: |+
    Identity Parameter
    To construct, see NOTES section for INPUTOBJECT properties and create a hash table.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Location
  isRequired: true
  description: |+
    The geo-location where the resource lives

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: MachineName
  isRequired: true
  description: |+
    The name of the machine where the extension should be created or updated.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    The name of the machine extension.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: NoWait
  description: |+
    Run the command asynchronously

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.Api20200802.IMachineExtensionPropertiesProtectedSettings" data-throw-if-not-resolved="False" />
  name: ProtectedSetting
  description: |+
    The extension can contain either protectedSettings or protectedSettingsFromKeyVault or no protected settings at all.

  defaultValue: None
  position: Named
  aliases: ProtectedSettings
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Publisher
  description: |+
    The name of the extension handler publisher.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ResourceGroupName
  isRequired: true
  description: |+
    The name of the resource group.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.PowerShell.Cmdlets.ConnectedMachine.Models.Api20200802.IMachineExtensionPropertiesSettings" data-throw-if-not-resolved="False" />
  name: Setting
  description: |+
    Json formatted public settings for the extension.

  defaultValue: None
  position: Named
  aliases: Settings
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: SubscriptionId
  description: |+
    Subscription credentials which uniquely identify Microsoft Azure subscription.
    The subscription ID forms part of the URI for every service call.

  defaultValue: (Get-AzContext).Subscription.Id
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Collections.Hashtable" data-throw-if-not-resolved="False" />
  name: Tag
  description: |+
    Resource tags.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: TypeHandlerVersion
  description: |+
    Specifies the version of the script handler.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: Az.ConnectedMachine.New-AzConnectedMachineExtension
name: New-AzConnectedMachineExtension
description: |-
  The operation to create or update the extension.
metadata:
  external help file: ""
  Module Name: Az.ConnectedMachine
  online version: https://docs.microsoft.com/en-us/powershell/module/az.connectedmachine/new-azconnectedmachineextension
  schema: 2.0.0
  content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/ConnectedMachine/help/New-AzConnectedMachineExtension.md
  original_content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/ConnectedMachine/help/New-AzConnectedMachineExtension.md
