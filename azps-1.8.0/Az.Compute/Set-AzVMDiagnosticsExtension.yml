### YamlMime:PowershellCmdlet
summary: |-
  Configures the Azure diagnostics extension on a virtual machine.
module: Az.Compute
notes: ""
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.IStorageContext" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Azure.Commands.Compute.Models.PSAzureOperationResponse" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-AzVMDiagnosticsExtension
  href: ./Get-AzVMDiagnosticsExtension.yml
- text: Get-AzVMExtensionImage
  href: ./Get-AzVMExtensionImage.yml
- text: Remove-AzVMDiagnosticsExtension
  href: ./Remove-AzVMDiagnosticsExtension.yml
syntaxes:
- >-
  Set-AzVMDiagnosticsExtension [-ResourceGroupName] <String> [-VMName] <String>

   [-DiagnosticsConfigurationPath] <String> [[-StorageAccountName] <String>] [[-StorageAccountKey] <String>]

   [[-StorageAccountEndpoint] <String>] [[-StorageContext] <IStorageContext>] [[-Location] <String>]

   [[-Name] <String>] [[-TypeHandlerVersion] <String>] [[-AutoUpgradeMinorVersion] <Boolean>]

   [-DefaultProfile <IAzureContextContainer>] [<CommonParameters>]
examples:
- title: 'Example 1: Enable diagnostics using a storage account specified in a diagnostics configuration file'
  code: |-
    PS C:\> Set-AzVMDiagnosticsExtension -ResourceGroupName "ResourceGroup01" -VMName "VirtualMachine02" -DiagnosticsConfigurationPath "diagnostics_publicconfig.xml"
  description: |-
    This command uses a diagnostics configuration file to enable diagnostics.
    The file diagnostics_publicconfig.xml contains the public XML configuration for the diagnostics extension including the name of the storage account to which diagnostics data will be sent.
    The diagnostics storage account must be in the same subscription as the virtual machine.
  summary: ""
- title: 'Example 2: Enable diagnostics using a storage account name'
  code: |-
    PS C:\> Set-AzVMDiagnosticsExtension -ResourceGroupName "ResourceGroup1" -VMName "VirtualMachine2" -DiagnosticsConfigurationPath diagnostics_publicconfig.xml -StorageAccountName "MyStorageAccount"
  description: |-
    This command uses the storage account name to enable diagnostics.
    If the diagnostics configuration does not specify a storage account name or if you want to override the diagnostics storage account name specified in the configuration file, use the *StorageAccountName* parameter.
    The diagnostics storage account must be in the same subscription as the virtual machine.
  summary: ""
- title: 'Example 3: Enable diagnostics using storage account name and key'
  code: |-
    PS C:\> Set-AzVMDiagnosticsExtension -ResourceGroupName "ResourceGroup01" -VMName "VirtualMachine02" -DiagnosticsConfigurationPath "diagnostics_publicconfig.xml" -StorageAccountName "MyStorageAccount" -StorageAccountKey $storage_key
  description: |-
    This command uses the storage account name and key to enable diagnostics.
    If the diagnostics storage account is in a different subscription than the virtual machine then enable sending diagnostics data to that storage account by explicitly specifying its name and key.
  summary: ""
parameters:
- type: <xref href="System.Boolean" data-throw-if-not-resolved="False" />
  name: AutoUpgradeMinorVersion
  description: |+
    Indicates whether this cmdlet allows the Azure guest agent to automatically update the extension to a newer minor version.

  defaultValue: None
  pipelineInput: true
  position: "10"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.Core.IAzureContextContainer" data-throw-if-not-resolved="False" />
  name: DefaultProfile
  description: |+
    The credentials, account, tenant, and subscription used for communication with azure.

  defaultValue: None
  position: Named
  aliases: AzContext, AzureRmContext, AzureCredential
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DiagnosticsConfigurationPath
  isRequired: true
  description: |+
    Specifies the path of the configuration file.

  defaultValue: None
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Location
  description: |+
    Specifies the location of the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "7"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Name
  description: |+
    Specifies the name of an extension.

  defaultValue: None
  pipelineInput: true
  position: "8"
  aliases: ExtensionName
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ResourceGroupName
  isRequired: true
  description: |+
    Specifies the name of the resource group of the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: StorageAccountEndpoint
  description: |+
    Specifies the storage account endpoint.

  defaultValue: None
  pipelineInput: true
  position: "5"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: StorageAccountKey
  description: |+
    Specifies the storage account key.

  defaultValue: None
  pipelineInput: true
  position: "4"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: StorageAccountName
  description: |+
    Specifies the storage account name.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.IStorageContext" data-throw-if-not-resolved="False" />
  name: StorageContext
  description: |+
    Specifies the Azure storage context.

  defaultValue: None
  pipelineInput: true
  position: "6"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: TypeHandlerVersion
  description: |+
    Specifies the version of the extension to use for this virtual machine.
    To obtain the version, run the Get-AzVMExtensionImage cmdlet with a value of Microsoft.Compute for the *PublisherName* parameter and VMAccessAgent for the *Type* parameter.

  defaultValue: None
  pipelineInput: true
  position: "9"
  aliases: HandlerVersion, Version
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: VMName
  isRequired: true
  description: |+
    Specifies the name of the virtual machine on which this cmdlet operates.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ResourceName
  parameterValueGroup: ""
uid: Az.Compute.Set-AzVMDiagnosticsExtension
name: Set-AzVMDiagnosticsExtension
description: |-
  The **Set-AzVMDiagnosticsExtension** cmdlet configures the Azure diagnostics extension on a virtual machine.
metadata:
  external help file: Microsoft.Azure.PowerShell.Cmdlets.Compute.dll-Help.xml
  Module Name: Az.Compute
  ms.assetid: 13ED884A-6224-4BD4-9F12-F896932F7842
  online version: https://docs.microsoft.com/en-us/powershell/module/az.compute/set-azvmdiagnosticsextension
  schema: 2.0.0
  content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Set-AzVMDiagnosticsExtension.md
  original_content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Set-AzVMDiagnosticsExtension.md
