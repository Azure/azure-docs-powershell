### YamlMime:PowershellCmdlet
summary: |-
  Saves a virtual machine as a VMImage.
module: Az.Compute
notes: ""
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Azure.Commands.Compute.Models.PSComputeLongRunningOperation" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-AzVMImage
  href: ./Get-AzVMImage.yml
- text: Get-AzVMImageOffer
  href: ./Get-AzVMImageOffer.yml
- text: Get-AzVMImagePublisher
  href: ./Get-AzVMImagePublisher.yml
- text: Get-AzVMImageSku
  href: ./Get-AzVMImageSku.yml
- text: Set-AzVM
  href: ./Set-AzVM.yml
syntaxes:
- >-
  Save-AzVMImage [-Name] <String> [-DestinationContainerName] <String> [-VHDNamePrefix] <String> [-Overwrite]

   [[-Path] <String>] [-ResourceGroupName] <String> [-AsJob] [-DefaultProfile <IAzureContextContainer>]

   [<CommonParameters>]
- >-
  Save-AzVMImage [[-Name] <String>] [-DestinationContainerName] <String> [-VHDNamePrefix] <String> [-Overwrite]

   [[-Path] <String>] [-Id] <String> [-AsJob] [-DefaultProfile <IAzureContextContainer>] [<CommonParameters>]
examples:
- title: 'Example 1: Capture a virtual machine'
  code: |-
    PS C:\> Set-AzVM -ResourceGroupName "ResourceGroup11" -Name "VirtualMachine07" -Generalized 
    PS C:\> Save-AzVMImage -ResourceGroupName "ResourceGroup11" -VMName "VirtualMachine07" -DestinationContainerName "VMContainer01" -VHDNamePrefix "VM07"
  description: |-
    The first command marks the virtual machine named VirtualMachine07 as generalized.
    The second command captures a virtual machine named VirtualMachine07 as a VMImage.
    The **Output** property returns a JSON template.
  summary: ""
parameters:
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsJob
  description: |+
    Run cmdlet in the background and return a Job to track progress.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Azure.Commands.Common.Authentication.Abstractions.Core.IAzureContextContainer" data-throw-if-not-resolved="False" />
  name: DefaultProfile
  description: |+
    The credentials, account, tenant, and subscription used for communication with azure.

  defaultValue: None
  position: Named
  aliases: AzContext, AzureRmContext, AzureCredential
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: DestinationContainerName
  isRequired: true
  description: |+
    Specifies the name of a container inside the "system" container that you want to hold your images.
    If the container doesn't exist, it is created for you.
    The virtual hard disks (VHDs) that constitute the VMImage reside in the container that this parameter specifies.
    If the VHDs are spread across multiple storage accounts, this cmdlet creates one container that has this name in each storage account.
    The URL of the saved image is similar to: 
    https://\<storageAccountName\>.blob.core.windows.net/system/Microsoft.Compute/Images/\<imagesContainer\>/\<vhdPrefix-osDisk\>.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd.

  defaultValue: None
  pipelineInput: true
  position: "2"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Id
  isRequired: true
  description: |+
    Specifies the Resource ID of the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Specifies a name.

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: VMName
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: Overwrite
  description: |+
    Indicates that this cmdlet overwrites any VHDs that have the same prefix in the destination container.

  defaultValue: None
  pipelineInput: true
  position: "4"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Path
  description: |+
    The file path in which the template of the captured image is stored.

  defaultValue: None
  pipelineInput: true
  position: "5"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ResourceGroupName
  isRequired: true
  description: |+
    Specifies the name of the resource group of the virtual machine.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: VHDNamePrefix
  isRequired: true
  description: |+
    Specifies the prefix in the name of the blobs that constitute the storage profile of the VMImage.
    For example, a prefix vhdPrefix for an operating system disk results in the name vhdPrefix-osdisk.\<guid\>.vhd.

  defaultValue: None
  pipelineInput: true
  position: "3"
  aliases: VirtualHardDiskNamePrefix
  parameterValueGroup: ""
uid: Az.Compute.Save-AzVMImage
name: Save-AzVMImage
description: |-
  The **Save-AzVMImage** cmdlet saves a virtual machine as a VMImage.
  Before you create a virtual machine image, sysprep the virtual machine, and then mark it as generalized by using the Set-AzVM cmdlet.
  The output of this cmdlet is a JavaScript Object Notation (JSON) template.
  You can deploy virtual machines from your captured image.
metadata:
  external help file: Microsoft.Azure.PowerShell.Cmdlets.Compute.dll-Help.xml
  Module Name: Az.Compute
  ms.assetid: D2B5BC27-6D51-45BC-AE6A-F7FED11B8651
  online version: https://docs.microsoft.com/en-us/powershell/module/az.compute/save-azvmimage
  schema: 2.0.0
  content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Save-AzVMImage.md
  original_content_git_url: https://github.com/Azure/azure-powershell/blob/master/src/Compute/Compute/help/Save-AzVMImage.md
